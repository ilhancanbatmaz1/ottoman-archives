<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ottoman Toolkit (Preview)</title>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Aref+Ruqaa:wght@400;700&family=Noto+Naskh+Arabic:wght@400;700&family=Gulzar&family=Cinzel:wght@700&display=swap"
        rel="stylesheet">

    <style>
        .font-rika {
            font-family: 'Aref Ruqaa', serif;
        }

        .font-matbu {
            font-family: 'Noto Naskh Arabic', serif;
        }

        .font-talik {
            font-family: 'Gulzar', serif;
            line-height: 2.2;
        }

        .font-classic {
            font-family: 'Cinzel', serif;
        }

        .paper-texture {
            background-color: #f9f7f1;
            background-image: url("https://www.transparenttextures.com/patterns/cream-paper.png");
        }
    </style>
</head>

<body class="bg-stone-100 text-stone-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { BookOpen, Scroll, Search, FileText, CheckSquare, AlignCenter, ArrowRightLeft, Layers, PenTool, Copy, X, BookCheck } = lucide;

        // --- MOCK DATA & API ---
        const GLOBAL_DICTIONARY = {
            "ben": "بن", "sen": "سن", "o": "او", "biz": "بز", "siz": "سز", "onlar": "اونلر",
            "bu": "بو", "şu": "شو", "bunlar": "بونلر", "şunlar": "شونلر",
            "kim": "كيم", "ne": "نه", "nerede": "نره ده", "nasıl": "ناصل", "niçin": "نيچون",
            "ve": "و", "ile": "ايله", "de": "داخي", "da": "داخي", "ki": "كه", "mi": "مي", "mı": "مي",
            "gel": "گل", "git": "گيت", "al": "آل", "ver": "وير", "yap": "ياپ", "et": "ايت",
            "zaman": "زمان", "vakit": "وقت", "an": "آن", "saat": "ساعت", "dakika": "دقيقه",
            "devlet": "دولت", "millet": "ملت", "vatan": "وطن", "memleket": "مملكت", "hükümet": "حكومت",
            "osmanlı": "عثمانلي", "türkiye": "توركيه", "istanbul": "استانبول",
            "insan": "انسان", "adam": "آدم", "kadın": "قادين", "erkek": "اركك", "çocuk": "چوجوق",
            "allah": "الله", "tanrı": "تاڭري", "hüda": "خدا", "rab": "رب",
            "güzel": "گوزل", "çirkin": "چركن", "iyi": "ايو", "kötü": "كوتو", "fena": "فنا"
        };

        const mockApi = {
            search: (q) => {
                return new Promise(resolve => {
                    setTimeout(() => {
                        if (!q || q.length < 2) return resolve([]);
                        const lowerQ = q.toLowerCase();
                        const results = Object.entries(GLOBAL_DICTIONARY)
                            .filter(([k, v]) => k.includes(lowerQ) || v.includes(lowerQ))
                            .slice(0, 20)
                            .map(([k, v], idx) => ({ id: idx, turkish: k, ottoman: v }));
                        resolve(results);
                    }, 200);
                });
            },
            batchLookup: (words) => {
                return new Promise(resolve => {
                    setTimeout(() => {
                        const result = {};
                        words.forEach(w => {
                            const lower = w.toLowerCase();
                            if (GLOBAL_DICTIONARY[lower]) {
                                result[lower] = GLOBAL_DICTIONARY[lower];
                            }
                        });
                        resolve(result);
                    }, 200);
                });
            }
        };

        // --- COMPONENTS ---

        const InputGroup = ({ label, value, onChange, dir = 'ltr', font = '', type = 'text' }) => (
            <div className="space-y-1">
                <label className="text-xs font-bold text-stone-500 uppercase">{label}</label>
                <input
                    type={type}
                    value={value}
                    onChange={(e) => onChange(e.target.value)}
                    dir={dir}
                    className={`w-full p-2 border rounded focus:ring-2 focus:ring-amber-500 outline-none ${font}`}
                />
            </div>
        );

        const TabButton = ({ active, onClick, icon, label }) => (
            <button
                onClick={onClick}
                className={`flex items-center gap-2 px-3 py-2 rounded-md transition-all text-xs md:text-sm font-medium whitespace-nowrap ${active
                        ? 'bg-amber-100 text-amber-900 shadow-sm'
                        : 'text-amber-100 hover:bg-amber-800'
                    }`}
            >
                <i data-lucide={icon}></i>
                <span>{label}</span>
            </button>
        );

        // 1. Dictionary Lookup
        const DictionaryLookup = () => {
            const [query, setQuery] = useState('');
            const [results, setResults] = useState([]);

            useEffect(() => {
                const timer = setTimeout(async () => {
                    const data = await mockApi.search(query);
                    setResults(data);
                }, 300);
                return () => clearTimeout(timer);
            }, [query]);

            return (
                <div className="max-w-xl mx-auto bg-white p-6 rounded-xl shadow-sm border border-stone-200 min-h-[500px]">
                    <div className="flex items-center gap-3 mb-6 border-b pb-4 text-stone-700">
                        <Search size={24} />
                        <div>
                            <h2 className="text-lg font-bold">Osmanlıca Lügat (Preview)</h2>
                            <p className="text-xs text-stone-500">Mock veritabanında arama yapın.</p>
                        </div>
                    </div>
                    <div className="relative mb-6">
                        <input
                            type="text"
                            value={query}
                            onChange={(e) => setQuery(e.target.value)}
                            placeholder="Kelime ara (örn: kalem, mektep)..."
                            className="w-full p-4 pl-12 border-2 border-stone-200 rounded-xl focus:border-amber-500 outline-none text-lg"
                        />
                        <Search className="absolute left-4 top-1/2 transform -translate-y-1/2 text-stone-400" size={20} />
                    </div>
                    <div className="space-y-2">
                        {results.map((entry) => (
                            <div key={entry.id} className="flex items-center justify-between p-4 bg-stone-50 hover:bg-amber-50 rounded-lg border border-stone-100 transition-colors group">
                                <span className="font-bold text-stone-700 capitalize">{entry.turkish}</span>
                                <span className="font-matbu text-2xl text-amber-800 group-hover:scale-110 transition-transform" dir="rtl">{entry.ottoman}</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // 2. Converter
        const LatinToOttomanConverter = () => {
            const [input, setInput] = useState('');
            const [output, setOutput] = useState('');

            const hasBackVowel = (word) => /[aıou]/i.test(word);
            const transliterateFallback = (word) => {
                const isBack = hasBackVowel(word);
                const charMap = {
                    'a': isBack ? 'ا' : 'ه', 'b': 'ب', 'c': 'ج', 'ç': 'چ', 'd': 'د', 'e': 'ه',
                    'f': 'ف', 'g': isBack ? 'غ' : 'گ', 'ğ': 'غ', 'h': 'ه', 'ı': 'ى', 'i': 'ي',
                    'j': 'ژ', 'k': isBack ? 'ق' : 'ك', 'l': 'ل', 'm': 'م', 'n': 'ن',
                    'o': 'و', 'ö': 'و', 'p': 'پ', 'r': 'ر', 's': isBack ? 'ص' : 'س',
                    'ş': 'ش', 't': isBack ? 'ط' : 'ت', 'u': 'و', 'ü': 'و', 'v': 'و', 'y': 'ي', 'z': 'ز',
                    ' ': ' ', '.': '.', ',': '،', '?': '؟'
                };
                let converted = word.toLowerCase().split('').map(char => charMap[char] || char).join('');
                if (word.toLowerCase().startsWith('a')) converted = 'آ' + converted.slice(1);
                return converted;
            };

            useEffect(() => {
                if (!input) { setOutput(''); return; }
                const process = async () => {
                    const words = input.split(/(\s+|[.,?!:;()])/).filter(w => w.trim().length > 0);
                    const lookupWords = words.filter(w => !w.match(/^[.,?!:;()]+$/));
                    const map = await mockApi.batchLookup(lookupWords);

                    const res = input.split(/(\s+|[.,?!:;()])/).map(w => {
                        if (w.trim() === '' || w.match(/^[.,?!:;()]+$/)) return w;
                        const lower = w.toLowerCase();
                        return map[lower] || transliterateFallback(w);
                    }).join('');
                    setOutput(res);
                };
                const t = setTimeout(process, 500);
                return () => clearTimeout(t);
            }, [input]);

            return (
                <div className="max-w-2xl mx-auto bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <div className="flex items-center gap-3 mb-6 border-b pb-4 text-stone-700">
                        <ArrowRightLeft size={24} />
                        <div><h2 className="text-lg font-bold">Latin {'->'} Osmanlıca</h2></div>
                    </div>
                    <div className="grid md:grid-cols-2 gap-6">
                        <textarea value={input} onChange={e => setInput(e.target.value)} className="w-full h-64 p-4 border-2 border-stone-200 rounded-xl" placeholder="Metin giriniz..." />
                        <div className="w-full h-64 p-4 bg-amber-50/50 border-2 border-amber-100 rounded-xl overflow-y-auto">
                            <p className="text-2xl font-rika text-stone-800 leading-loose" dir="rtl">{output}</p>
                        </div>
                    </div>
                </div>
            );
        };

        // 3. Card Generator (Simplified)
        const CardGenerator = () => {
            const [word, setWord] = useState('Müverrih');
            const [ottoman, setOttoman] = useState('مورخ');
            return (
                <div className="grid md:grid-cols-2 gap-8">
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <InputGroup label="Kelime" value={word} onChange={setWord} />
                        <InputGroup label="Osmanlıca" value={ottoman} onChange={setOttoman} dir="rtl" font="font-matbu" />
                    </div>
                    <div className="flex items-center justify-center p-4 bg-stone-200 rounded-xl">
                        <div className="w-[320px] aspect-[4/5] bg-[#f3e5ab] flex flex-col items-center justify-center text-center shadow-2xl border-4 border-double border-stone-400">
                            <span className="text-6xl font-matbu mb-4" dir="rtl">{ottoman}</span>
                            <h2 className="text-3xl font-bold uppercase">{word}</h2>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App
        const App = () => {
            const [activeTab, setActiveTab] = useState('generator');

            return (
                <div className="min-h-screen">
                    <header className="bg-amber-900 text-amber-50 p-4 shadow-md sticky top-0 z-10">
                        <div className="max-w-6xl mx-auto flex items-center justify-between">
                            <h1 className="text-xl font-bold flex items-center gap-2"><PenTool size={20} /> İlhan ile Osmanlıca (Preview)</h1>
                            <nav className="flex gap-2">
                                <button onClick={() => setActiveTab('generator')} className={`px-3 py-1 rounded ${activeTab === 'generator' ? 'bg-amber-100 text-amber-900' : ''}`}>Post</button>
                                <button onClick={() => setActiveTab('dictionary')} className={`px-3 py-1 rounded ${activeTab === 'dictionary' ? 'bg-amber-100 text-amber-900' : ''}`}>Lügat</button>
                                <button onClick={() => setActiveTab('converter')} className={`px-3 py-1 rounded ${activeTab === 'converter' ? 'bg-amber-100 text-amber-900' : ''}`}>Çevirici</button>
                            </nav>
                        </div>
                    </header>
                    <main className="max-w-4xl mx-auto p-6 space-y-6">
                        {activeTab === 'generator' && <CardGenerator />}
                        {activeTab === 'dictionary' && <DictionaryLookup />}
                        {activeTab === 'converter' && <LatinToOttomanConverter />}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>